{
  "info": {
    "_postman_id": "8c9f2b3a-7d4e-4c8f-a5e6-92cd7e1f3a4b",
    "name": "Bingwa - USSD Code Management",
    "description": "USSD code management for offers including priority management, signature learning, and failover support",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "30662231"
  },
  "item": [
    {
      "name": "üìã USSD Code - List & Retrieve",
      "item": [
        {
          "name": "List All USSD Codes",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Get all USSD codes for an offer (sorted by priority)"
          },
          "response": []
        },
        {
          "name": "Get Active USSD Codes",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/active",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", "active"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Get only active USSD codes sorted by priority (for mobile app)"
          },
          "response": []
        },
        {
          "name": "Get Primary USSD Code",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/primary",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", "primary"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Get the primary (priority 1) USSD code"
          },
          "response": []
        },
        {
          "name": "Get USSD Code Stats",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/stats",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", "stats"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Get statistics for all USSD codes (success rate, total attempts)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "‚ûï USSD Code - Create & Update",
      "item": [
        {
          "name": "Add USSD Code (Auto Priority 1)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ussd_code\": \"*456*1*12*4*2*BH*1*1#\",\n  \"signature_pattern\": \"*456*1*12*\",\n  \"priority\": 0,\n  \"processing_type\": \"multistep\",\n  \"expected_response\": \"success\",\n  \"error_pattern\": \"insufficient|failed|error\",\n  \"metadata\": {\n    \"description\": \"Alternative USSD code for Tunukiwa\",\n    \"network\": \"Safaricom\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Add new USSD code. If priority is 0 or 1, becomes new priority 1 and shifts others down"
          },
          "response": []
        },
        {
          "name": "Add USSD Code (Specific Priority)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ussd_code\": \"*456*1*20*4*2*BH*1*1#\",\n  \"signature_pattern\": \"*456*1*20*\",\n  \"priority\": 3,\n  \"processing_type\": \"multistep\",\n  \"expected_response\": \"successful\",\n  \"error_pattern\": \"failed\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Add USSD code with specific priority (must be unique)"
          },
          "response": []
        },
        {
          "name": "Update USSD Code",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ussd_code\": \"*456*1*12*4*2*BH*1*1#\",\n  \"signature_pattern\": \"*456*1*12*\",\n  \"priority\": 2,\n  \"is_active\": true,\n  \"expected_response\": \"success|completed\",\n  \"error_pattern\": \"insufficient|failed\",\n  \"processing_type\": \"multistep\",\n  \"metadata\": {\n    \"updated_reason\": \"Improved signature pattern\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/:ussd_code_id",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", ":ussd_code_id"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                },
                {
                  "key": "ussd_code_id",
                  "value": "2",
                  "description": "USSD Code ID"
                }
              ]
            },
            "description": "Update USSD code details (all fields optional)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üîÑ USSD Code - Priority Management",
      "item": [
        {
          "name": "Set USSD Code as Primary",
          "request": {
            "method": "PUT",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/:ussd_code_id/set-primary",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", ":ussd_code_id", "set-primary"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                },
                {
                  "key": "ussd_code_id",
                  "value": "3",
                  "description": "USSD Code ID to set as primary"
                }
              ]
            },
            "description": "Set a USSD code as priority 1 (primary). Other codes shift automatically"
          },
          "response": []
        },
        {
          "name": "Reorder USSD Codes",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"codes\": [\n    {\n      \"id\": 1,\n      \"priority\": 2\n    },\n    {\n      \"id\": 2,\n      \"priority\": 1\n    },\n    {\n      \"id\": 3,\n      \"priority\": 3\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/reorder",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", "reorder"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Bulk reorder USSD codes. All codes must have unique priorities"
          },
          "response": []
        }
      ]
    },
    {
      "name": "‚öôÔ∏è USSD Code - Status & Deletion",
      "item": [
        {
          "name": "Deactivate USSD Code",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"is_active\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/:ussd_code_id/toggle-status",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", ":ussd_code_id", "toggle-status"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                },
                {
                  "key": "ussd_code_id",
                  "value": "2",
                  "description": "USSD Code ID"
                }
              ]
            },
            "description": "Deactivate a USSD code. Cannot deactivate last active code"
          },
          "response": []
        },
        {
          "name": "Activate USSD Code",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"is_active\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/:ussd_code_id/toggle-status",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", ":ussd_code_id", "toggle-status"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                },
                {
                  "key": "ussd_code_id",
                  "value": "2",
                  "description": "USSD Code ID"
                }
              ]
            },
            "description": "Activate a previously deactivated USSD code"
          },
          "response": []
        },
        {
          "name": "Delete USSD Code",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/:ussd_code_id",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", ":ussd_code_id"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                },
                {
                  "key": "ussd_code_id",
                  "value": "3",
                  "description": "USSD Code ID to delete"
                }
              ]
            },
            "description": "Delete a USSD code. Cannot delete last code. Other priorities auto-adjust"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üìä USSD Code - Usage Tracking",
      "item": [
        {
          "name": "Record USSD Success",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ussd_code_id\": 1,\n  \"success\": true,\n  \"response\": \"Successfully purchased 5GB bundle. Valid for 30 days\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/record-result",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", "record-result"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Record successful USSD execution (from mobile app)"
          },
          "response": []
        },
        {
          "name": "Record USSD Failure",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ussd_code_id\": 1,\n  \"success\": false,\n  \"response\": \"Insufficient balance to complete transaction\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/offers/:id/ussd-codes/record-result",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "offers", ":id", "ussd-codes", "record-result"],
              "variable": [
                {
                  "key": "id",
                  "value": "1",
                  "description": "Offer ID"
                }
              ]
            },
            "description": "Record failed USSD execution (from mobile app)"
          },
          "response": []
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{access_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    }
  ]
}